# Powerful Proxy 完整使用手册

> 🚀 高性能网络代理与游戏加速工具 - 详细使用指南

---

## 目录

1. [软件概述](#1-软件概述)
2. [安装配置](#2-安装配置)
3. [快速上手](#3-快速上手)
4. [服务器管理](#4-服务器管理)
5. [代理模式详解](#5-代理模式详解)
6. [高级设置](#6-高级设置)
7. [常见应用场景](#7-常见应用场景)
8. [故障排除](#8-故障排除)
9. [技术参考](#9-技术参考)

---

## 1. 软件概述

### 1.1 什么是 Powerful Proxy？

Powerful Proxy 是一款基于 Netch 深度定制的 Windows 网络代理工具。它能够：

- **代理指定程序的网络流量** - 精确控制哪些应用走代理
- **加速游戏连接** - 降低延迟，改善游戏体验
- **突破网络限制** - 访问受限的网络资源
- **支持多种代理协议** - 兼容主流代理服务

### 1.2 核心优势

| 特性             | 说明                                            |
| ---------------- | ----------------------------------------------- |
| **多协议支持**   | Shadowsocks、VMess、VLESS、Trojan、WireGuard 等 |
| **灵活代理模式** | 进程代理、全局代理、TUN 模式等                  |
| **智能分流**     | 自动识别国内外流量，智能选择路由                |
| **低资源占用**   | 高效的底层实现，最小化系统资源消耗              |
| **游戏优化**     | 专为游戏加速设计的 UDP 转发支持                 |

### 1.3 工作原理

```
┌─────────────────────────────────────────────────────────────────────┐
│                        Powerful Proxy 工作流程                       │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   ┌──────────┐    ┌──────────────┐    ┌──────────────┐             │
│   │  应用程序 │───▶│   流量拦截器   │───▶│   代理客户端  │             │
│   │ (游戏/浏览器)│    │ (NF/TUN驱动)  │    │  (Xray核心)  │             │
│   └──────────┘    └──────────────┘    └──────────────┘             │
│                          │                    │                     │
│                          ▼                    ▼                     │
│                   ┌──────────────┐    ┌──────────────┐             │
│                   │   规则匹配    │    │   代理服务器  │             │
│                   │  (代理/直连)  │    │  (您的节点)   │             │
│                   └──────────────┘    └──────────────┘             │
│                                              │                      │
│                                              ▼                      │
│                                       ┌──────────────┐             │
│                                       │   目标网站    │             │
│                                       │  /游戏服务器  │             │
│                                       └──────────────┘             │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 2. 安装配置

### 2.1 系统要求

| 项目     | 最低要求             | 推荐配置          |
| -------- | -------------------- | ----------------- |
| 操作系统 | Windows 10 版本 1809 | Windows 11 最新版 |
| 处理器   | 任意 x64 处理器      | -                 |
| 内存     | 512 MB 可用内存      | 1 GB+             |
| 磁盘空间 | 200 MB               | 500 MB            |
| 网络     | 能连接互联网         | -                 |
| 权限     | 管理员权限           | 管理员权限        |

### 2.2 运行时依赖

在运行本软件前，请确保已安装：

**必需：**
[.NET 8.0 Desktop Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)

下载链接：https://dotnet.microsoft.com/download/dotnet/8.0

### 2.3 安装步骤

#### 步骤 1：下载软件

1. 访问
   [Releases 页面](https://github.com/Huo-zai-feng-lang-li/Powerful-proxy/releases)
2. 下载最新版本的 `Netch-x64.zip`

#### 步骤 2：解压软件

1. 将压缩包解压到一个**不包含中文和特殊字符**的路径
2. 推荐路径示例：
   - ✅ `D:\Tools\Netch`
   - ✅ `C:\Programs\Netch`
   - ❌ `D:\工具\Netch`
   - ❌ `C:\Program Files\Netch` (包含空格)

#### 步骤 3：首次运行

1. 右键点击 `Netch.exe`
2. 选择 **"以管理员身份运行"**
3. 如果弹出防火墙提示，请点击 **"允许访问"**

### 2.4 目录结构说明

```
Netch/
├── Netch.exe              # 主程序
├── bin/                   # 核心组件
│   ├── Redirector.bin     # 流量重定向器
│   ├── RouteHelper.bin    # 路由管理器
│   ├── tun2socks.bin      # TUN 模式核心
│   ├── xray.exe           # Xray 代理核心
│   ├── wintun.dll         # WinTUN 驱动
│   └── ...
├── data/                  # 数据文件
│   └── settings.json      # 配置文件
├── mode/                  # 代理模式规则
│   ├── Custom/            # 自定义模式
│   └── ...
├── i18n/                  # 语言文件
└── logging/               # 日志文件
```

---

## 3. 快速上手

### 3.1 主界面介绍

```
┌─────────────────────────────────────────────────────────────────┐
│  Powerful Proxy                                    [─] [□] [×]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  服务器: [▼ 选择服务器                                    ] [+] │
│                                                                  │
│  模式:   [▼ 选择代理模式                                  ] [E] │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                            │ │
│  │                      服务器列表区域                         │ │
│  │                                                            │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  状态: 未启动                           [ 启动 ]  [ 测试延迟 ]  │
│                                                                  │
│  上传: 0 B/s        下载: 0 B/s        NAT 类型: -              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 添加第一个服务器

#### 方式一：订阅导入（推荐）

1. 点击菜单 **订阅** → **管理订阅**
2. 点击 **添加**
3. 填写订阅信息：
   - **备注**：给订阅起个名字
   - **链接**：粘贴您的订阅地址
4. 点击 **保存**
5. 点击 **更新** 获取服务器列表

#### 方式二：剪贴板导入

1. 复制服务器分享链接（如 `vmess://...`、`ss://...`）
2. 点击菜单 **服务器** → **从剪贴板导入**
3. 服务器会自动添加到列表

#### 方式三：手动添加

1. 点击菜单 **服务器** → **添加 [协议类型]**
2. 填写服务器参数
3. 点击 **添加**

### 3.3 选择代理模式

在 **模式** 下拉框中选择合适的模式：

| 模式名称                     | 适用场景                 |
| ---------------------------- | ------------------------ |
| **Bypass LAN and China**     | 日常使用，绕过国内流量   |
| **Steam Games (with Steam)** | Steam 游戏加速           |
| **Discord**                  | Discord 语音/视频加速    |
| **Global**                   | 全部流量代理（TUN 模式） |

### 3.4 启动代理

1. 选择服务器
2. 选择模式
3. 点击 **启动** 按钮
4. 状态显示 "运行中" 表示成功

---

## 4. 服务器管理

### 4.1 支持的协议格式

| 协议         | 链接格式示例                    |
| ------------ | ------------------------------- |
| Shadowsocks  | `ss://BASE64编码@服务器:端口`   |
| ShadowsocksR | `ssr://BASE64编码`              |
| VMess        | `vmess://BASE64编码`            |
| VLESS        | `vless://UUID@服务器:端口?参数` |
| Trojan       | `trojan://密码@服务器:端口`     |

### 4.2 订阅管理

#### 添加订阅

1. 菜单 → 订阅 → 管理订阅
2. 填写订阅链接
3. 可设置自动更新间隔

#### 更新订阅

- **手动更新**：菜单 → 订阅 → 更新订阅
- **自动更新**：在订阅设置中开启

### 4.3 服务器测速

1. 在服务器列表中选择服务器
2. 右键 → **测试延迟**
3. 或点击工具栏的 **测试延迟** 按钮批量测试

### 4.4 服务器分组

- 服务器会按订阅来源自动分组
- 可以在列表中通过分组筛选服务器

---

## 5. 代理模式详解

### 5.1 进程代理模式 (Process Mode)

**原理**：使用 NetFilter 驱动拦截指定程序的网络请求

**优点**：

- 精确控制，不影响其他程序
- 资源占用低
- 配置灵活

**缺点**：

- 需要知道程序的进程名称
- 部分 UWP 应用可能不支持

**模式文件格式**：

```text
# 每行一个进程名称
chrome.exe
firefox.exe
Telegram.exe
```

### 5.2 TUN 模式 (全局模式)

**原理**：创建虚拟网卡，接管系统所有网络流量

**优点**：

- 无需配置进程名称
- 支持所有应用程序
- 完整的 UDP 支持（游戏必备）

**缺点**：

- 资源占用相对较高
- 需要安装 WinTUN 驱动

**模式文件格式**（JSON）：

```json
{
  "Bypass": ["192.168.0.0/16", "10.0.0.0/8"],
  "Handle": ["0.0.0.0/0"]
}
```

### 5.3 Web 代理模式

**原理**：提供本地 HTTP/SOCKS5 代理端口

**使用方式**：

1. 启动后获取本地代理端口
2. 在浏览器或应用中配置代理

**默认端口**：

- SOCKS5：`127.0.0.1:1080`
- HTTP：`127.0.0.1:1081`

### 5.4 自定义模式

#### 创建进程模式

1. 在 `mode\Custom` 目录下创建 `.txt` 文件
2. 文件内容格式：

```text
# 备注: 我的自定义模式
# 类型: Process

应用1.exe
应用2.exe
```

#### 创建 TUN 模式

1. 在 `mode\Custom` 目录下创建 `.json` 文件
2. 文件内容格式：

```json
{
  "Remark": "我的TUN模式",
  "Bypass": ["局域网IP"],
  "Handle": ["要代理的IP"]
}
```

---

## 6. 高级设置

### 6.1 基本设置

| 设置项       | 说明               | 默认值   |
| ------------ | ------------------ | -------- |
| 系统语言     | 界面语言           | 跟随系统 |
| 开机启动     | 系统启动时自动运行 | 关闭     |
| 启动时最小化 | 启动后最小化到托盘 | 关闭     |
| 退出时确认   | 关闭窗口时询问     | 开启     |

### 6.2 SOCKS5 设置

| 设置项         | 说明                 | 默认值 |
| -------------- | -------------------- | ------ |
| 本地端口       | SOCKS5 代理端口      | 1080   |
| 允许局域网连接 | 其他设备可通过此代理 | 关闭   |
| 用户名/密码    | 代理认证             | 空     |

### 6.3 TUN/TAP 设置

| 设置项      | 说明          | 默认值        |
| ----------- | ------------- | ------------- |
| 地址        | 虚拟网卡 IP   | 10.0.236.10   |
| 网关        | 虚拟网关      | 10.0.236.1    |
| 子网掩码    | 网络掩码      | 255.255.255.0 |
| DNS         | 自定义 DNS    | 自动          |
| 全局绕过 IP | 始终直连的 IP | 局域网IP      |

### 6.4 DNS 设置

| 设置项         | 说明                           |
| -------------- | ------------------------------ |
| 使用自定义 DNS | 启用后使用指定的 DNS           |
| 中国 DNS       | 解析国内域名 (推荐: 223.5.5.5) |
| 其他 DNS       | 解析国外域名 (推荐: 1.1.1.1)   |
| 代理 DNS 请求  | DNS 请求走代理                 |

---

## 7. 常见应用场景

### 7.1 AI 开发工具加速

适用于：Cursor、Antigravity IDE、GitHub Copilot 等

**推荐配置**：

1. 模式：`Bypass LAN and China`
2. 或创建自定义模式：

```text
# AI开发工具代理
Cursor.exe
Antigravity.exe
Code.exe
node.exe
git.exe
```

### 7.2 Steam 游戏加速

**推荐配置**：

1. 模式：`Steam Games (with Steam)`
2. 如果需要更完整的加速，使用 TUN 模式

### 7.3 Discord 语音加速

**推荐配置**：

1. 模式：`Discord`
2. 确保服务器支持 UDP 转发

### 7.4 浏览器代理

**配置步骤**：

1. 启动软件
2. 在浏览器中安装代理扩展（如 SwitchyOmega）
3. 配置 SOCKS5 代理：`127.0.0.1:1080`

### 7.5 游戏主机加速

适用于：PS4、PS5、Switch、Xbox

**使用 pcap2socks 模式**：

1. 选择 `pcap2socks` 相关模式
2. 将主机网关设置为电脑 IP
3. 电脑需通过网线连接路由器

---

## 8. 故障排除

### 8.1 常见错误及解决

#### ❌ "请解压后运行程序"

**原因**：程序在压缩包内运行或 bin 文件夹缺失

**解决**：

1. 完整解压所有文件
2. 确保 `bin` 文件夹存在且不为空

#### ❌ "端口被占用"

**原因**：SOCKS5 端口被其他程序占用

**解决**：

1. 关闭占用端口的程序
2. 或修改设置中的端口号

#### ❌ 驱动安装失败

**原因**：安全软件拦截或权限不足

**解决**：

1. 临时关闭杀毒软件
2. 确保以管理员身份运行
3. 手动复制驱动：

```powershell
copy bin\wintun.dll C:\Windows\System32\
```

#### ❌ 连接超时

**原因**：服务器不可用或网络问题

**解决**：

1. 测试服务器延迟
2. 尝试其他服务器
3. 检查防火墙设置

#### ❌ TUN 模式无法启动

**原因**：WinTUN 驱动问题

**解决**：

1. 重新安装程序
2. 检查是否有其他 VPN 软件冲突
3. 尝试重启电脑

### 8.2 日志查看

日志文件位置：`logging\application.log`

查看日志命令：

```powershell
Get-Content logging\application.log -Tail 100
```

### 8.3 重置配置

如果软件异常，可以重置配置：

```powershell
# 删除配置文件
Remove-Item data\settings.json

# 清空日志
Remove-Item logging\* -Force
```

---

## 9. 技术参考

### 9.1 核心组件说明

| 组件        | 语言 | 功能                 |
| ----------- | ---- | -------------------- |
| Netch       | C#   | 主程序界面和业务逻辑 |
| Redirector  | C++  | NetFilter 驱动接口   |
| RouteHelper | C++  | Windows 路由表管理   |
| tun2socks   | Go   | TUN 模式核心         |
| Xray        | Go   | 多协议代理核心       |

### 9.2 支持的订阅格式

- **Base64 编码列表**：标准订阅格式
- **Clash YAML**：部分支持
- **SIP008**：Shadowsocks 标准格式

### 9.3 命令行参数

| 参数           | 说明         |
| -------------- | ------------ |
| `-show`        | 显示主窗口   |
| `-forceUpdate` | 强制检查更新 |

### 9.4 API 端口

启动后，程序会提供以下本地代理端口：

| 端口 | 协议   | 说明          |
| ---- | ------ | ------------- |
| 1080 | SOCKS5 | 默认代理端口  |
| 1081 | HTTP   | HTTP 代理端口 |

---

## 附录：快捷键

| 快捷键   | 功能          |
| -------- | ------------- |
| `Ctrl+Q` | 退出程序      |
| `Ctrl+W` | 最小化到托盘  |
| `Enter`  | 启动/停止代理 |

---

<p align="center">
  <b>祝您使用愉快！</b>
  <br>
  如有问题，欢迎在 <a href="https://github.com/Huo-zai-feng-lang-li/Powerful-proxy/issues">GitHub Issues</a> 反馈
</p>
